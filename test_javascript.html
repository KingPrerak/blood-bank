<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Test - Blood Bank</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2><i class="fas fa-bug me-2"></i>JavaScript Error Test</h2>
        
        <div class="card">
            <div class="card-header">
                <h5>Test Alert Functions</h5>
            </div>
            <div class="card-body">
                <button class="btn btn-success me-2" onclick="testAlert('success', 'Success message test')">Test Success</button>
                <button class="btn btn-danger me-2" onclick="testAlert('error', 'Error message test')">Test Error</button>
                <button class="btn btn-warning me-2" onclick="testAlert('warning', 'Warning message test')">Test Warning</button>
                <button class="btn btn-info me-2" onclick="testAlert('info', 'Info message test')">Test Info</button>
                
                <hr>
                
                <h6>Test Donor Search:</h6>
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id="test-search" placeholder="Enter search term" value="prerak">
                    <button class="btn btn-primary" onclick="testSearch()">Test Search</button>
                </div>
                
                <div id="search-results"></div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Test alert function
        function testAlert(type, message) {
            try {
                const alertClass = type === "success" ? "alert-success" : 
                                  type === "error" ? "alert-danger" : 
                                  type === "warning" ? "alert-warning" : "alert-info";
                
                const alertHtml = `<div class="alert ${alertClass} alert-dismissible fade show" role="alert">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>`;
                
                // Remove existing alerts
                document.querySelectorAll(".alert").forEach(alert => alert.remove());
                
                // Add new alert
                document.querySelector(".container").insertAdjacentHTML("afterbegin", alertHtml);
                
                // Auto-dismiss
                setTimeout(() => {
                    const alert = document.querySelector(".alert");
                    if (alert) alert.remove();
                }, 3000);
                
                console.log("Alert test successful:", type, message);
                
            } catch (error) {
                console.error("Alert test failed:", error);
            }
        }
        
        // Test search function
        function testSearch() {
            const query = document.getElementById("test-search").value;
            
            if (!query) {
                testAlert("warning", "Please enter a search term");
                return;
            }
            
            testAlert("info", "Testing search...");
            
            $.ajax({
                url: "ajax/search_donor.php",
                type: "GET",
                data: { query: query },
                success: function(response) {
                    console.log("Search test response:", response);
                    
                    if (response.success) {
                        testAlert("success", "Search test successful! Donor found.");
                        
                        const donor = response.donor;
                        const html = `
                            <div class="alert alert-info">
                                <h6>Donor Found:</h6>
                                <p><strong>ID:</strong> ${donor.donor_id}</p>
                                <p><strong>Name:</strong> ${donor.first_name} ${donor.last_name}</p>
                                <p><strong>Blood Group:</strong> ${donor.blood_group}</p>
                                <p><strong>Phone:</strong> ${donor.phone}</p>
                            </div>
                        `;
                        document.getElementById("search-results").innerHTML = html;
                    } else {
                        testAlert("error", "Search test failed: " + response.message);
                    }
                },
                error: function(xhr, status, error) {
                    console.error("Search test error:", error);
                    testAlert("error", "Search test failed with error: " + error);
                }
            });
        }
        
        // Test on page load
        $(document).ready(function() {
            console.log("JavaScript test page loaded successfully");
            testAlert("info", "JavaScript test page loaded. All functions working!");
        });
    </script>
</body>
</html>